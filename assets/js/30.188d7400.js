(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{480:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("跨域问题及其解决方案\n")]),t._v(" "),a("h2",{attrs:{id:"为什么会出现跨域问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么会出现跨域问题"}},[t._v("#")]),t._v(" 为什么会出现跨域问题")]),t._v(" "),a("p",[t._v("由于浏览器的同源策略，导致我们在日常开发或者上线部署的时候会出现跨域问题。")]),t._v(" "),a("blockquote",[a("p",[t._v("同源策略：协议、域名、端口在不相同的情况下，由于浏览器的安全策略，或导致跨域问题。")])]),t._v(" "),a("h2",{attrs:{id:"如何解决跨域"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何解决跨域"}},[t._v("#")]),t._v(" 如何解决跨域")]),t._v(" "),a("p",[t._v("常用的解决跨域问题的解决方案：")]),t._v(" "),a("ol",[a("li",[t._v("jsonp")]),t._v(" "),a("li",[t._v("nginx反向代理")]),t._v(" "),a("li",[t._v("webpack devServer代理")]),t._v(" "),a("li",[t._v("cors跨源资源共享")])]),t._v(" "),a("p",[t._v("其中jsonp由于其局限性，以及对比其他方案的效果。此处不做介绍。")]),t._v(" "),a("h3",{attrs:{id:"nginx方向代理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx方向代理"}},[t._v("#")]),t._v(" nginx方向代理")]),t._v(" "),a("p",[t._v("nginx反向代理常用在开发环境及线上环境。通过拦截转发请求来处理跨域问题。")]),t._v(" "),a("p",[t._v("假如现在前端项目运行在8080端口，而实际后端项目的地址为"),a("code",[t._v("https://1.1.1.1:9000")]),t._v("，需要拦截前缀为api的请求，此时nginx配置为")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("\nserver "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen      "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v(" default_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    location /api "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        proxy_pass https://1.1.1.1:9000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("假如现在有个接口为"),a("code",[t._v("/api/test")]),t._v(",在没有做转发前为"),a("code",[t._v("http://localhost:8080/api/test")]),t._v(",实际接口位置为"),a("code",[t._v("https://1.1.1.1:9000/api/test")]),t._v(".结果转发为实际接口位置。")]),t._v(" "),a("h3",{attrs:{id:"webpack-devserver代理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webpack-devserver代理"}},[t._v("#")]),t._v(" webpack devserver代理")]),t._v(" "),a("p",[t._v("webpack devserver代理用在开发环境。")]),t._v(" "),a("p",[t._v("配置如下")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("devServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    proxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            target"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://1.1.1.1:9000'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            changeOrigin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            pathRewrite"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'^/api'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'api'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"cors跨源资源共享"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cors跨源资源共享"}},[t._v("#")]),t._v(" cors跨源资源共享")]),t._v(" "),a("p",[t._v("跨源资源共享 (CORS) （或通俗地译为跨域资源共享）是一种基于HTTP 头的机制，该机制通过允许服务器标示除了它自己以外的其它origin（域，协议和端口），这样浏览器可以访问加载这些资源。")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("Access-Control-Allow-Origin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 'xxx'\n")])])]),a("p",[t._v("可以通过服务端设置"),a("code",[t._v("Access-Control-Allow-Origin")]),t._v("字段的白名单来处理跨域问题。")]),t._v(" "),a("blockquote",[a("p",[t._v("如果在此情况下，发送请求时需要带上cookie的话，则需要配置"),a("code",[t._v("Access-Control-Allow-Credentials")]),t._v(",同时客户端需要同步设置"),a("code",[t._v("xhr.withCredentials = true;")]),t._v(",两者缺一不可")])]),t._v(" "),a("Vssue")],1)}),[],!1,null,null,null);s.default=e.exports}}]);